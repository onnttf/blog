{"id":"D_kwDONzrbkM4AeNZs","title":"å¦‚ä½•ä¿æŒ SSH æœåŠ¡ä¸æ‰çº¿","body":"åœ¨æ—¥å¸¸å·¥ä½œä¸­ï¼Œä¿æŒ `SSH` æœåŠ¡ä¸æ‰çº¿æ˜¯ä¸€ä¸ªéå¸¸é‡è¦çš„éœ€æ±‚ã€‚å¸¸è§ä¿æŒ `SSH` æœåŠ¡ä¸æ‰çº¿çš„æ–¹æ³•æœ‰ä¸¤ç§ï¼š\r\n\r\n1. æœåŠ¡ç«¯å‘é€å¿ƒè·³åŒ…\r\n2. å®¢æˆ·ç«¯å‘é€å¿ƒè·³åŒ…\r\n\r\nè¿™ä¸¤ç§æ–¹æ¡ˆéƒ½èƒ½æœ‰æ•ˆè§£å†³ `SSH` è¿æ¥æ–­å¼€çš„é—®é¢˜ã€‚æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å°†æ·±å…¥æ¢è®¨è¿™ä¸¤ç§æ–¹æ¡ˆçš„å…·ä½“é…ç½®æ–¹æ³•ã€‚\r\n\r\n## æœåŠ¡ç«¯å‘é€å¿ƒè·³åŒ…\r\n\r\n1. ç™»å½•æœåŠ¡å™¨åï¼Œæ‰“å¼€é…ç½®æ–‡ä»¶\r\n\r\n   ```bash\r\n   sudo vim /etc/ssh/sshd_config\r\n   ```\r\n\r\n2. æ£€æŸ¥å¹¶é…ç½®å¿ƒè·³åŒ…ç›¸å…³å‚æ•°\r\n\r\n   1. æ‰¾åˆ°ä»¥ä¸‹ä¸¤ä¸ªå…³é”®é…ç½®é¡¹ï¼ˆå¦‚æœ‰ `#`ï¼Œéœ€è¦å»æ‰ï¼‰\r\n\r\n      - `ClientAliveInterval` - æ§åˆ¶æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å‘é€å¿ƒè·³åŒ…çš„æ—¶é—´é—´éš”\r\n      - `ClientAliveCountMax` - è®¾ç½®å¿ƒè·³åŒ…æ£€æµ‹å¤±è´¥çš„æœ€å¤§é‡è¯•æ¬¡æ•°\r\n\r\n   2. æ¨èçš„å‚æ•°é…ç½®\r\n\r\n      ```ini\r\n      # æ¯ 30 ç§’å‘é€ä¸€æ¬¡å¿ƒè·³åŒ…æ£€æµ‹ï¼Œå¯ä»¥åŠæ—¶å‘ç°è¿æ¥å¼‚å¸¸\r\n      ClientAliveInterval 30\r\n      # å…è®¸è¿ç»­ 3 æ¬¡å¿ƒè·³åŒ…å¤±è´¥ï¼Œåœ¨ç½‘ç»œæ³¢åŠ¨æ—¶ä»ä¿æŒç¨³å®š\r\n      ClientAliveCountMax 3\r\n      ```\r\n\r\n3. ä¿å­˜é…ç½®æ–‡ä»¶\r\n\r\n   - æŒ‰ `ESC` é”®é€€å‡ºç¼–è¾‘æ¨¡å¼\r\n   - è¾“å…¥ `:wq` ä¿å­˜æ–‡ä»¶å¹¶é€€å‡º\r\n   - å¦‚é‡åˆ°æƒé™é—®é¢˜ï¼Œä½¿ç”¨ `:w!` å¼ºåˆ¶ä¿å­˜\r\n\r\n4. é‡å¯ `SSH` æœåŠ¡åº”ç”¨æ–°é…ç½®\r\n\r\n   ```bash\r\n   sudo systemctl restart ssh\r\n   ```\r\n\r\n> æ ¸å¿ƒå‚æ•°è¯¦è§£ï¼š\r\n>\r\n> **ClientAliveInterval**\r\n>\r\n> - åŠŸèƒ½ï¼šæœåŠ¡å™¨å®šæ—¶å‘é€å¿ƒè·³åŒ…æ£€æµ‹å®¢æˆ·ç«¯æ˜¯å¦å­˜æ´»\r\n> - å•ä½ï¼šç§’ï¼ˆsï¼‰\r\n> - é»˜è®¤ï¼š`0`ï¼ˆç¦ç”¨ï¼‰\r\n> - å»ºè®®ï¼š`30` ç§’ï¼ˆå¹³è¡¡æ€§èƒ½ä¸åŠæ—¶æ€§ï¼‰\r\n> - è¯´æ˜ï¼šè¶…è¿‡è®¾å®šæ—¶é—´æœªæ”¶åˆ°å®¢æˆ·ç«¯å“åº”ï¼Œåˆ™å‘é€å¿ƒè·³åŒ…\r\n>\r\n> **ClientAliveCountMax**\r\n>\r\n> - åŠŸèƒ½ï¼šå…è®¸å¿ƒè·³æ£€æµ‹å¤±è´¥çš„æœ€å¤§æ¬¡æ•°\r\n> - é»˜è®¤ï¼š`3`\r\n> - å»ºè®®ï¼š`3` æ¬¡ï¼ˆå¯é æ€§ä¸èµ„æºæ¶ˆè€—çš„æœ€ä½³å¹³è¡¡ï¼‰\r\n> - ä½œç”¨ï¼šé˜²æ­¢ä¸´æ—¶ç½‘ç»œæ³¢åŠ¨é€ æˆè¿æ¥æ–­å¼€\r\n> - è¯´æ˜ï¼šå®é™…æœ€å¤§è¶…æ—¶æ—¶é—´ = é—´éš” Ã— æ¬¡æ•°\r\n\r\n## å®¢æˆ·ç«¯å‘é€å¿ƒè·³åŒ…\r\n\r\n1. è¿›å…¥å®¢æˆ·ç«¯çš„ `SSH` é…ç½®ç›®å½•\r\n\r\n   ```bash\r\n   cd ~/.ssh/\r\n   ```\r\n\r\n2. æ‰“å¼€é…ç½®æ–‡ä»¶\r\n\r\n   ```bash\r\n   vim config\r\n   ```\r\n\r\n3. æ·»åŠ ä»¥ä¸‹å¿ƒè·³é…ç½®å‚æ•°å¹¶ä¿å­˜\r\n\r\n   ```ini\r\n   # é…ç½®å®¢æˆ·ç«¯æ¯ 30 ç§’å‘é€ä¸€æ¬¡å¿ƒè·³åŒ…\r\n   ServerAliveInterval 30\r\n   # å…è®¸æœ€å¤š 120 æ¬¡é‡è¯•\r\n   ServerAliveCountMax 120\r\n   ```\r\n\r\n4. ä¿å­˜å¹¶é€€å‡º\r\n\r\n   - æŒ‰ `ESC` é”®é€€å‡ºç¼–è¾‘æ¨¡å¼\r\n   - è¾“å…¥ `:wq` ä¿å­˜å¹¶é€€å‡º\r\n\r\n> æ ¸å¿ƒå‚æ•°è¯´æ˜ï¼š\r\n>\r\n> **ServerAliveInterval**\r\n>\r\n> - åŠŸèƒ½ï¼šå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€å¿ƒè·³çš„æ—¶é—´é—´éš”\r\n> - å•ä½ï¼šç§’ï¼ˆsï¼‰\r\n> - é»˜è®¤å€¼ï¼š`0`ï¼ˆè¡¨ç¤ºç¦ç”¨ï¼‰\r\n> - å»ºè®®å€¼ï¼š`20-60` ç§’\r\n> - æ³¨æ„ï¼šè®¾ç½®è¿‡å°ä¼šå¢åŠ æœåŠ¡å™¨è´Ÿè½½\r\n>\r\n> **ServerAliveCountMax**\r\n>\r\n> - åŠŸèƒ½ï¼šå®¢æˆ·ç«¯å…è®¸å¿ƒè·³æ£€æµ‹å¤±è´¥çš„æœ€å¤§æ¬¡æ•°\r\n> - é»˜è®¤å€¼ï¼š`3`\r\n> - å»ºè®®å€¼ï¼šæ ¹æ®éœ€è¦è®¾ç½®ï¼Œé€šå¸¸ `100-999`\r\n> - è¯´æ˜ï¼šå®é™…æœ€å¤§ä¿æŒæ—¶é—´ = é—´éš” Ã— æ¬¡æ•°\r\n\r\n## å¦‚ä½•é€‰æ‹©æœ€ä½³æ–¹æ¡ˆ\r\n\r\nä¸¤ç§æ–¹æ¡ˆå„æœ‰ä¼˜åŠ¿ï¼Œé€‰æ‹©å“ªç§ä¸»è¦å–å†³äºæ‚¨çš„å…·ä½“ä½¿ç”¨åœºæ™¯ï¼š\r\n\r\n- **ä¸€å°æœåŠ¡å™¨è¿æ¥å¤šä¸ªå®¢æˆ·ç«¯**\r\n\r\n  æ¨èæœåŠ¡ç«¯å¿ƒè·³æ–¹æ¡ˆï¼Œåªéœ€åœ¨æœåŠ¡å™¨é…ç½®ä¸€æ¬¡ï¼Œå¯¹æ‰€æœ‰å®¢æˆ·ç«¯ç”Ÿæ•ˆ\r\n\r\n- **ä¸€å°å®¢æˆ·ç«¯è¿æ¥å¤šå°æœåŠ¡å™¨**\r\n\r\n  æ¨èå®¢æˆ·ç«¯å¿ƒè·³æ–¹æ¡ˆï¼Œåªéœ€åœ¨å®¢æˆ·ç«¯é…ç½®ä¸€æ¬¡ï¼Œå¯¹æ‰€æœ‰æœåŠ¡å™¨è¿æ¥ç”Ÿæ•ˆ\r\n","number":20,"labels":{"nodes":[]},"category":{"id":"DIC_kwDONzrbkM4Cmnbf","name":"Show and tell","slug":"show-and-tell","emoji":":raised_hands:","emojiHTML":"<div>ğŸ™Œ</div>"},"author":{"login":"onnttf"},"authorAssociation":"OWNER","createdAt":"2020-03-01T08:00:00Z","updatedAt":"2025-02-05T11:00:10Z","repository":{"id":"R_kgDONzrbkA","url":"https://github.com/onnttf/blog"},"url":"https://github.com/onnttf/blog/discussions/20","jsonFilePath":"discussions/20-D_kwDONzrbkM4AeNZs.json","markdownFilePath":"2020/3/20-D_kwDONzrbkM4AeNZs.md"}
